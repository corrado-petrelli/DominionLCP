package rules

import com.project.Player;
import com.project.Action;
import com.project.cards.Card;
import com.project.cards.kingdoms.*;
import com.project.cards.treasures.*;
import com.project.cards.victories.*;
import com.project.cards.curses.*;
import java.util.*;

//List of trash cards
global List<Card> trashPile;
//Random logic
global Random gameLogic;


/*
 _______  __   __  __    _  _______  _______  ___   _______  __    _  _______ 
|       ||  | |  ||  |  | ||       ||       ||   | |       ||  |  | ||       |
|    ___||  | |  ||   |_| ||       ||_     _||   | |   _   ||   |_| ||  _____|
|   |___ |  |_|  ||       ||       |  |   |  |   | |  | |  ||       || |_____ 
|    ___||       ||  _    ||      _|  |   |  |   | |  |_|  ||  _    ||_____  |
|   |    |       || | |   ||     |_   |   |  |   | |       || | |   | _____| |
|___|    |_______||_|  |__||_______|  |___|  |___| |_______||_|  |__||_______|
*/
//A Player *p* draw *amound* cards from the deck
function void draw(Player p, int amount) {
	for(int i = 0; i < amount; i++) {
		p.getHand().add(p.getDeck().remove(0));
	}
	System.out.println(p.getUsername() + " drew " + amount + " cards.");
}

//A player *p* obtain *amount* virtual coins
function void coin(Player p, int amount) {
	p.setVirtualCoins(amount);
	System.out.println(p.getUsername() + " obtained " + amount + " coins");
}

//A player *p* buy a card *c*
function void buy(Player p, Card c) {
	p.getDiscard().add(c);
	System.out.println(p.getUsername() + " bought " + c.getName());
}

//A player *p* is cursed!
function void beCursed(Player p) {
	p.getDiscard().add(new com.project.cards.curses.Curse());
	System.out.println(p.getUsername() + " obtained a Curse");
}

//A player *p* discard *amount* card (in random way)
function void discard(Player p, int amount) {
	Random r = new Random();
	for(int i = 0; i < amount; i++) {
		p.getHand().remove(r.nextInt(p.getHand().size()-1));
	}
	System.out.println(p.getUsername() + " discarded " + amount + " cards.");
}

//A player *p* add from discard pile *amount* card in random way
function void addFromDiscardPile(Player p, int amount) {
	Random r = new Random();
	for(int i = 0; i < amount; i++) {
		Card c = p.getDiscard().remove(r.nextInt(p.getDiscard().size()));
		p.getHand().add(c);
		System.out.println(p.getUsername() + " added " + c.getName() + " from his/her discard pile.");
	}
	System.out.println(p.getUsername() + " added a total of " + amount + " cards from his/her discard pile.");
}


function void addActions(Player p, int amount) {
	p.setActions(p.getActions()+amount);
	System.out.println(p.getUsername() + " can do " + amount + " more actions.");
}


function void addPurchase(Player p, int amount) {
	p.setPurchases(p.getPurchases()+amount);
	System.out.println(p.getUsername() + " can purchase " + amount + " more cards.");
}

/*
function void trash(Player p, Card c) {
	p.getHand().remove(index);
	trashPile.add(c);
}
*/

/*
 _______  ___      _______  __   __                                                
|       ||   |    |   _   ||  | |  |                                               
|    _  ||   |    |  |_|  ||  |_|  |                                               
|   |_| ||   |    |       ||       |                                               
|    ___||   |___ |       ||_     _|                                               
|   |    |       ||   _   |  |   |                                                 
|___|    |_______||__| |__|  |___|                                                 
 _______  ______    _______  _______  _______  __   __  ______    _______  _______ 
|       ||    _ |  |       ||   _   ||       ||  | |  ||    _ |  |       ||       |
|_     _||   | ||  |    ___||  |_|  ||  _____||  | |  ||   | ||  |    ___||  _____|
  |   |  |   |_||_ |   |___ |       || |_____ |  |_|  ||   |_||_ |   |___ | |_____ 
  |   |  |    __  ||    ___||       ||_____  ||       ||    __  ||    ___||_____  |
  |   |  |   |  | ||   |___ |   _   | _____| ||       ||   |  | ||   |___  _____| |
  |___|  |___|  |_||_______||__| |__||_______||_______||___|  |_||_______||_______|
*/

/*
rule "Play Treasures card"
	when
		$player : Player( $username : username )
		$card : Treasure( $amount : value )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		coin($player,$amount);
		retract($player)
		retract($card)
		retract($action)
end
*/

rule "Play Copper card"
	when
		$player : Player( $username : username )
		$card : Copper( $amount : value )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		coin($player,$amount);
		retract($player)
		retract($card)
		retract($action)
end

rule "Play Silver card"
	when
		$player : Player( $username : username )
		$card : Silver( $amount : value )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		coin($player,$amount);
		retract($player)
		retract($card)
		retract($action)
end

rule "Play Gold card"
	when
		$player : Player( $username : username )
		$card : Copper( $amount : value )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		coin($player,$amount);
		retract($player)
		retract($card)
		retract($action)
end

/*
 _______  __   __  __   __                                                  
|  _    ||  | |  ||  | |  |                                                 
| |_|   ||  | |  ||  |_|  |                                                 
|       ||  |_|  ||       |                                                 
|  _   | |       ||_     _|                                                 
| |_|   ||       |  |   |                                                   
|_______||_______|  |___|                                                   
 __   __  ___   _______  _______  _______  ______    ___   _______  _______ 
|  | |  ||   | |       ||       ||       ||    _ |  |   | |       ||       |
|  |_|  ||   | |       ||_     _||   _   ||   | ||  |   | |    ___||  _____|
|       ||   | |       |  |   |  |  | |  ||   |_||_ |   | |   |___ | |_____ 
|       ||   | |      _|  |   |  |  |_|  ||    __  ||   | |    ___||_____  |
 |     | |   | |     |_   |   |  |       ||   |  | ||   | |   |___  _____| |
  |___|  |___| |_______|  |___|  |_______||___|  |_||___| |_______||_______|                                                                                               
*/
/*
rule "Buy Victories card"
	when
		$player : Player( $username : username )
		$card : Victory(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end
*/

rule "Buy Estate card"
	when
		$player : Player( $username : username )
		$card : Estate(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Duchy card"
	when
		$player : Player( $username : username )
		$card : Duchy(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Province card"
	when
		$player : Player( $username : username )
		$card : Province(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end



/*
 _______  ___      _______  __   __                         
|       ||   |    |   _   ||  | |  |                        
|    _  ||   |    |  |_|  ||  |_|  |                        
|   |_| ||   |    |       ||       |                        
|    ___||   |___ |       ||_     _|                        
|   |    |       ||   _   |  |   |                          
|___|    |_______||__| |__|  |___|                          
 ___   _  ___   __    _  _______  ______   _______  __   __ 
|   | | ||   | |  |  | ||       ||      | |       ||  |_|  |
|   |_| ||   | |   |_| ||    ___||  _    ||   _   ||       |
|      _||   | |       ||   | __ | | |   ||  | |  ||       |
|     |_ |   | |  _    ||   ||  || |_|   ||  |_|  ||       |
|    _  ||   | | | |   ||   |_| ||       ||       || ||_|| |
|___| |_||___| |_|  |__||_______||______| |_______||_|   |_|
*/

/*
rule "Play Witch card"
	when
		$player : Player( $username : username )
		$opponents : List(  )
		$card : Witch(  )
		$action : Action( this == Action.USE )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end
*/
rule "Play Cellar card"
	when
		$player : Player( $username : username )
		$card : Cellar( $amount : amount )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		discard($player,$amount);
		draw($player,$amount);
		retract($player)
		retract($card)
		retract($action)
end


rule "Play Chapel card"
	when
		$player : Player( $username : username )
		$card : Chapel( $amount : amount )
		$action : Action( this == Action.USE )
	then
		
		System.out.println($username+" used "+$card.getName()+".");
		// trash cards here
		retract($player)
		retract($card)
		retract($action)
end

rule "Play Moat card"
	when
		$player : Player( $username : username )
		$card : Moat(  )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		draw($player,2);
		retract($player)
		retract($card)
		retract($action)
end


/*
rule "Play Harbinger card"
	when
		$player : Player( $username : username )
		$card : Harbinger(  )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used Harbinger.");
		draw($player,1);
		addActions($player,1);
		if(gameLogic.nextBoolean()) {
			addFromDiscardPile($player,1);
		}
		retract($player)
		retract($card)
		retract($action)
end
*/

rule "Play Village card"
	when
		$player : Player( $username : username )
		$card : Village(  )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		draw($player,1);
		addActions($player,2);
		retract($player)
		retract($card)
		retract($action)
end

rule "Play Smithy card"
	when
		$player : Player( $username : username )
		$card : Smithy(  )
		// I need the action to understand what the player will do with that card
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		draw($player,3);
		retract($player)
		retract($card)
		retract($action)
end

rule "Play Market card"
	when
		$player : Player( $username : username )
		$card : Market(  )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		draw($player,1);
		addActions($player,1);
		addPurchase($player,1);
		coin($player,1);
		retract($player)
		retract($card)
		retract($action)
end

rule "Play Militia card"
	when
		$player : Player( $username : username )
		$card : Market(  )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		draw($player,1);
		addActions($player,1);
		addPurchase($player,1);
		coin($player,1);
		retract($player)
		retract($card)
		retract($action)
end


rule "Play Mine card"
	when
		$player : Player( $username : username )
		$card : Mine(  )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		draw($player,1);
		addActions($player,1);
		addPurchase($player,1);
		coin($player,1);
		retract($player)
		retract($card)
		retract($action)
end


rule "Play Remodel card"
	when
		$player : Player( $username : username )
		$card : Remodel(  )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		draw($player,1);
		addActions($player,1);
		addPurchase($player,1);
		coin($player,1);
		retract($player)
		retract($card)
		retract($action)
end

rule "Play Woodcutter card"
	when
		$player : Player( $username : username )
		$card : Woodcutter(  )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		addPurchase($player,1);
		coin($player,2);
		retract($player)
		retract($card)
		retract($action)
end



rule "Play Workshop card"
	when
		$player : Player( $username : username )
		$card : Workshop(  )
		$action : Action( this == Action.USE )
	then
		System.out.println($username+" used "+$card.getName()+".");
		addPurchase($player,1);
		coin($player,2);
		retract($player)
		retract($card)
		retract($action)
end
/*
 _______  __   __  __   __                                  
|  _    ||  | |  ||  | |  |                                 
| |_|   ||  | |  ||  |_|  |                                 
|       ||  |_|  ||       |                                 
|  _   | |       ||_     _|                                 
| |_|   ||       |  |   |                                   
|_______||_______|  |___|                                   
 ___   _  ___   __    _  _______  ______   _______  __   __ 
|   | | ||   | |  |  | ||       ||      | |       ||  |_|  |
|   |_| ||   | |   |_| ||    ___||  _    ||   _   ||       |
|      _||   | |       ||   | __ | | |   ||  | |  ||       |
|     |_ |   | |  _    ||   ||  || |_|   ||  |_|  ||       |
|    _  ||   | | | |   ||   |_| ||       ||       || ||_|| |
|___| |_||___| |_|  |__||_______||______| |_______||_|   |_|
*/
/*
rule "Buy Kingdom card"
	when
		$player : Player( $username : username )
		$card : Kingdom(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end
*/

rule "Buy Cellar card"
	when
		$player : Player( $username : username )
		$card : Cellar(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Chapel card"
	when
		$player : Player( $username : username )
		$card : Chapel(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Moat card"
	when
		$player : Player( $username : username )
		$card : Moat(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Village card"
	when
		$player : Player( $username : username )
		$card : Village(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Smithy card"
	when
		$player : Player( $username : username )
		$card : Smithy(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Market card"
	when
		$player : Player( $username : username )
		$card : Market(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end
rule "Buy Militia card"
	when
		$player : Player( $username : username )
		$card : Militia(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end
rule "Buy Mine card"
	when
		$player : Player( $username : username )
		$card : Mine(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Remodel card"
	when
		$player : Player( $username : username )
		$card : Remodel(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Woodcutter card"
	when
		$player : Player( $username : username )
		$card : Woodcutter(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end

rule "Buy Workshop card"
	when
		$player : Player( $username : username )
		$card : Workshop(  )
		$action : Action( this == Action.BUY )
	then
		buy($player,$card);
		retract($player)
		retract($card)
		retract($action)
end